
/* === FLYMILY Responsive, No-H-Scroll Theme ===
   Goals: desktop+mobile first, zero horizontal scrolling,
   clean spacing, and comfortable tap targets.
   This file intentionally overrides and fixes any broken rules from the original.
*/
:root{
  --bg:#0f1115; --card:#151922; --ink:#e9eef4; --muted:#9fb0c0;
  --brand:#8bd3ff; --accent:#ffd166; --ok:#06d6a0; --danger:#ef476f;
  --border:#273142; --shadow:0 10px 30px rgba(0,0,0,.25);
}
[data-theme="light"]{
  --bg:#f7f8fb; --card:#ffffff; --ink:#0e1116; --muted:#415266;
  --brand:#0077ff; --accent:#faad14; --ok:#089e71; --danger:#d9363e;
  --border:#e6e9ef; --shadow:0 10px 20px rgba(0,0,0,.06);
}

*{box-sizing:border-box; max-width:100%;}
html,body{height:100%;}
/* Prevent any horizontal scroll, ever. */
html,body{overflow-x:hidden;}
body{
  margin:0; background:var(--bg); color:var(--ink);
  font-family:Rubik,system-ui,-apple-system,Segoe UI,Roboto,Arial;
  line-height:1.45; direction:rtl;
}

a{color:var(--brand); text-decoration:none}
img{display:block; max-width:100%; height:auto;}

.app{display:grid; grid-template-rows:auto 1fr; min-height:100vh;}
header{
  display:flex; align-items:center; gap:12px; padding:14px 18px;
  border-bottom:1px solid var(--border); background:var(--card);
  position:sticky; top:0; z-index:5; flex-direction:row;
}
header .logo{ width:38px; height:auto; }
.brand-text{ font-weight:700; letter-spacing:.5px; font-size:clamp(16px, 1.6vw, 20px); }
header .spacer{flex:1}
header .btn, .btn{
  background:transparent; border:1px solid var(--border); color:var(--ink);
  padding:8px 12px; border-radius:12px; cursor:pointer;
}
.btn.primary{border-color:var(--brand); background:color-mix(in oklab, var(--brand) 20%, transparent)}
.btn.danger{border-color:var(--danger); color:var(--danger)}
.btn:disabled{opacity:.5; cursor:not-allowed}
.btn.block{width:100%}

.container{
  display:grid; grid-template-columns:320px 1fr;
  height:calc(100vh - 56px);
  width:100vw; max-width:100vw;
}
.sidebar{
  border-inline-start:1px solid var(--border); background:var(--card);
  padding:16px; overflow:auto;
}
.content{ padding:16px; overflow:auto; }

.section-title{display:flex; align-items:center; gap:10px; margin:8px 0 12px}
.input, select, textarea{
  width:100%; background:transparent; border:1px solid var(--border);
  color:var(--ink); padding:10px 12px; border-radius:10px; outline:none;
}
textarea{ min-height:80px; resize:vertical; }
.row{ display:flex; flex-wrap:wrap; gap:10px; }
.row > *{ flex:1 min-content; }

.list-actions{ display:flex; gap:8px; align-items:center; margin-bottom:10px; flex-wrap:wrap;}
.tabs{
  display:flex; gap:8px; border-bottom:1px solid var(--border);
  position:sticky; top:0; background:var(--bg); padding-bottom:8px; z-index:4; overflow-x:auto;
}
.tabs button{ padding:10px 12px; border-radius:12px 12px 0 0; border:1px solid var(--border); border-bottom:none; background:var(--card); white-space:nowrap;}
.tabs button.active{ outline:2px solid color-mix(in oklab, var(--brand) 40%, transparent); }

.trip-card{ background:var(--card); border:1px solid var(--border); border-radius:16px; padding:14px; box-shadow:var(--shadow) }
.grid{ display:grid; grid-template-columns:repeat(auto-fill,minmax(260px,1fr)); gap:14px }
.list{ display:flex; flex-direction:column; gap:8px }

.trip-row{
  display:flex; flex-direction:column; gap:4px; padding:10px;
  border:1px solid var(--border); border-radius:12px; background:var(--card);
}
.trip-row .pill{ width:fit-content; margin-top:4px }
.muted{ color:var(--muted) }
.pill{ border:1px solid var(--border); padding:4px 8px; border-radius:999px; font-size:.85rem }

.cards{ display:grid; grid-template-columns:repeat(auto-fit,minmax(260px,1fr)); gap:12px; margin-top:12px }
.card{ background:var(--card); border:1px solid var(--border); border-radius:16px; padding:14px; box-shadow:var(--shadow) }

table{ width:100%; border-collapse:separate; border-spacing:0; table-layout:fixed; }
th,td{ border-bottom:1px solid var(--border); padding:10px; text-align:right; overflow:hidden; text-overflow:ellipsis; white-space:nowrap; }
th{ position:sticky; top:0; background:var(--card) }

.menu{ position:relative }
.menu-btn{ border:1px solid var(--border); background:transparent; border-radius:10px; padding:6px 10px }
.menu-list{ position:absolute; left:0; top:36px; background:var(--card); border:1px solid var(--border); border-radius:12px; min-width:160px; display:none; z-index:3 }
.menu-list.open{ display:block }
.menu-list button{ display:block; width:100%; padding:10px; background:transparent; border:none; text-align:right }

/* Leaflet map container: never exceed viewport */
.leaflet-container{
  width:100%; height:420px; border-radius:16px; border:1px solid var(--border);
}
.map-toolbar{ position:absolute; left:64px; top:12px; display:flex; gap:10px; z-index:1200; pointer-events:auto; }

dialog.modal{
  border:1px solid var(--border); border-radius:16px;
  background:var(--card); color:var(--ink); padding:0;
  max-width:480px; width:min(92vw, 480px);
}
.modal header{ padding:12px 16px; border-bottom:1px solid var(--border); background:transparent }
.modal .body{ padding:14px 16px }
.modal .footer{ display:flex; gap:8px; justify-content:flex-start; padding:12px 16px; border-top:1px solid var(--border) }

.toast{ position:fixed; inset-inline-end:16px; inset-block-end:16px; background:var(--card); border:1px solid var(--border); border-radius:12px; padding:10px 14px; box-shadow:var(--shadow); display:none; }
.toast.show{ display:block }

/* Modes */
.container.home-mode{ grid-template-columns: 1fr; }
.container.home-mode .content{ display: none; }
.container.home-mode .sidebar{ display:block; width:100%; max-width:1100px; margin:0 auto; }
.container.trip-mode{ grid-template-columns: 1fr; }
.container.trip-mode .sidebar{ display: none; }
.container.trip-mode .content{ display:block; }

/* === Budget Bar === */
.budget-bar{
  display:flex; align-items:center; gap:16px;
  border:1px solid var(--border); border-radius:22px; padding:12px 14px; background:var(--card);
  flex-wrap:wrap;
}
.budget-bar .bar-actions{ display:flex; gap:10px; flex-wrap:wrap; }
.budget-bar .btn.subtle{ border:1px solid var(--border); background:transparent; border-radius:12px; padding:6px 12px }
.budget-bar .bar-cols{ display:flex; gap:16px; margin-inline-start:auto; flex-wrap:wrap; }
.budget-bar .col{ display:flex; align-items:center; gap:8px; min-width:120px; }
.budget-bar .lbl{ color:var(--muted); font-size:14px }
.budget-bar .val{ font-size:16px }
.budget-bar .val.bold{ font-weight:700 }
.budget-bar .val.neg{ color:var(--danger) }
.budget-bar .badge{ border:1px solid var(--border); border-radius:12px; padding:6px 12px; background:var(--card) }

/* --- Meta tab tweaks if present --- */
#view-meta .card{ display:flex; flex-direction:column; gap:16px; padding:16px; }
#view-meta .card .row.dest-row{ display:grid; grid-template-columns:1fr auto; gap:8px; align-items:end; }
#view-meta .btn.map-btn{
  background:var(--card); border:1px solid var(--border); border-radius:10px; padding:10px 12px; height:42px;
}

/* === Responsive rules === */
@media (max-width: 1200px){
  .container{ grid-template-columns:280px 1fr; }
}
@media (max-width: 900px){
  .container{ grid-template-columns:1fr; height:auto; }
  .sidebar{ order:2; max-height:40vh; }
  .content{ order:1; }
  body{ overflow-y:auto; }
  .map-toolbar{ left:12px; }
}
@media (max-width: 560px){
  header{ padding:12px 12px; }
  .tabs{ gap:6px; }
  th,td{ padding:8px; }
  .budget-bar .col{ min-width:unset; }
}
