
<!DOCTYPE html>
<html lang="he" dir="rtl">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1, user-scalable=no" />
  <title>FLYMILY — Travel OS</title>
  <link href="https://fonts.googleapis.com/css2?family=Rubik:wght@400;500;700;800&display=swap" rel="stylesheet">
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css">
  <link rel="stylesheet" href="style.css" />
  <meta name="theme-color" content="#0f1216" />
</head>
<body>
  <header class="app-header" role="banner">
    <div class="brand">
      <div class="logo" aria-hidden="true">🗺️</div>
      <h1>FLYMILY</h1>
    </div>
    <div class="header-actions">
      <button id="themeToggle" class="icon-btn" title="מצב כהה/בהיר" aria-label="החלף מצב תאורה">🌗</button>
      <button id="openAuth" class="btn primary small">התחברות</button>
    </div>
  </header>

  <main id="app" role="main">
    <!-- Home / Trips -->
    <section id="view-trips" class="view active" aria-label="טיולים">
      <div class="toolbar">
        <h2>הטיולים שלי</h2>
        <div class="toolbar-actions">
          <input id="tripSearch" class="input" type="search" placeholder="חפש טיול לפי יעד או תיאור…" />
        </div>
      </div>
      <ul id="tripList" class="cards" aria-live="polite" aria-busy="false"></ul>
    </section>

    <!-- Single Trip -->
    <section id="view-trip" class="view" aria-label="טיול">
      <div class="breadcrumbs">
        <button id="backToTrips" class="btn ghost">← חזרה</button>
        <h2 id="tripTitle" class="trip-title">טיול</h2>
        <div class="share-controls">
          <label class="switch">
            <input id="shareToggle" type="checkbox" />
            <span class="slider"></span>
          </label>
          <span class="muted">שיתוף</span>
        </div>
      </div>

      <nav class="tabs" role="tablist" aria-label="ניווט טאביים">
        <button class="tab active" data-tab="overview" role="tab" aria-selected="true">סקירה</button>
        <button class="tab" data-tab="expenses" role="tab">הוצאות</button>
        <button class="tab" data-tab="journal" role="tab">יומן</button>
        <button class="tab" data-tab="map" role="tab">מפה</button>
        <button class="tab" data-tab="settings" role="tab">הגדרות</button>
      </nav>

      <div class="tab-panels">
        <!-- Overview -->
        <div id="panel-overview" class="panel active" role="tabpanel">
          <div class="card">
            <div class="budget-card-grid">
              <h3>תקציב</h3>
              <div class="budget-row">
                <div class="budget-label">תקציב טיול</div>
                <div id="sumBudget" class="currency-cell">—</div>
                <div class="budget-label">הוצאות בפועל</div>
                <div id="sumSpent" class="currency-cell">—</div>
                <div class="budget-label">יתרה</div>
                <div id="sumLeft" class="currency-cell">—</div>
                <div class="budget-label">מטבע</div>
                <div id="localCcyCell" class="currency-cell">USD</div>
              </div>
            </div>
            <div class="row gap">
              <button id="quickAddExpense" class="btn primary">+ הוצאה חדשה</button>
              <button id="openLocationPicker" class="btn">בחר מיקום</button>
            </div>
          </div>

          <div class="card">
            <h3>פעילות אחרונה</h3>
            <ul id="recentActivity" class="list"></ul>
          </div>
        </div>

        <!-- Expenses -->
        <div id="panel-expenses" class="panel" role="tabpanel">
          <div class="table-actions">
            <h3>רשימת הוצאות</h3>
            <div class="row gap">
              <select id="categoryFilter" class="input">
                <option value="">כל הקטגוריות</option>
                <option>תחבורה</option>
                <option>לינה</option>
                <option>אוכל</option>
                <option>אטרקציות</option>
                <option>קניות</option>
                <option>אחר</option>
              </select>
              <button id="addExpense" class="btn primary">+ הוסף</button>
            </div>
          </div>

          <ul id="expenseList" class="list expenses-list" aria-live="polite"></ul>
        </div>

        <!-- Journal -->
        <div id="panel-journal" class="panel" role="tabpanel">
          <div class="table-actions">
            <h3>יומן</h3>
            <button id="addJournal" class="btn primary">+ רשומה</button>
          </div>
          <ul id="journalList" class="list"></ul>
        </div>

        <!-- Map -->
        <div id="panel-map" class="panel" role="tabpanel">
          <div id="mainMap" class="map tall" role="application" aria-label="מפת הטיול"></div>
        </div>

        <!-- Settings -->
        <div id="panel-settings" class="panel" role="tabpanel">
          <div class="card">
            <h3>הגדרות טיול</h3>
            <div class="form compact">
              <div class="form-grid">
                <div class="form-col">
                  <label>שם/תיאור
                    <input id="tripNameInput" class="input" type="text" placeholder="למשל: שבוע בבודפשט"/>
                  </label>
                  <label>יעד
                    <input id="tripDestInput" class="input" type="text" placeholder="עיר/מדינה"/>
                  </label>
                </div>
                <div class="form-col">
                  <label>תקציב (USD)
                    <input id="tripBudgetInput" class="input" type="number" step="0.01" min="0"/>
                  </label>
                  <label class="checkbox-inline">
                    <input id="lockBudget" type="checkbox" /> נעל תקציב
                  </label>
                </div>
              </div>
              <div class="row gap">
                <button id="saveTripMeta" class="btn primary">שמור</button>
                <button id="deleteTrip" class="btn danger">מחק טיול</button>
              </div>
            </div>
          </div>
        </div>
      </div>
    </section>
  </main>

  <!-- Bottom nav + FAB -->
  <nav id="bottomNav" class="bottom-nav" role="navigation" aria-label="ניווט תחתון">
    <button data-nav="trips" class="bn-item active">טיולים</button>
    <button id="bnAdd" class="bn-fab" title="הוסף">＋</button>
    <button data-nav="settings" class="bn-item">הגדרות</button>
  </nav>

  <!-- Dialogs -->
  <dialog id="authDialog" class="dialog" aria-label="התחברות">
    <h3 class="dialog-title">התחברות</h3>
    <div class="dialog-content">
      <p class="muted">כדי לשמור ולסנכרן, התחבר עם Google.</p>
      <button id="googleBtn" class="btn primary wide">התחבר עם Google</button>
    </div>
    <div class="dialog-actions">
      <button class="btn ghost" data-close>סגור</button>
    </div>
  </dialog>

  <dialog id="expenseDialog" class="dialog" aria-label="הוספת הוצאה">
    <h3 class="dialog-title">הוצאה</h3>
    <form id="expenseForm" class="form compact dialog-content">
      <div class="form-grid">
        <div class="form-col">
          <label>תיאור
            <input name="desc" class="input" required placeholder="למשל: פיצה נאפוליטנה">
          </label>
          <label>קטגוריה
            <select name="category" class="input">
              <option>אוכל</option>
              <option>תחבורה</option>
              <option>לינה</option>
              <option>אטרקציות</option>
              <option>קניות</option>
              <option selected>אחר</option>
            </select>
          </label>
        </div>
        <div class="form-col">
          <label>סכום
            <input name="amount" class="input" type="number" step="0.01" required>
          </label>
          <label>מטבע
            <select name="currency" id="expenseCurrency" class="input"></select>
          </label>
        </div>
        <div class="form-col">
          <label>תאריך
            <input name="date" class="input" type="date">
          </label>
          <label>שעה
            <input name="time" class="input" type="time">
          </label>
        </div>
        <div class="form-col">
          <label>מיקום (רשות)
            <input name="place" class="input" placeholder="למשל: Bazilika, Budapest">
          </label>
          <label>קישור (רשות)
            <input name="link" class="input" placeholder="https://...">
          </label>
        </div>
      </div>
      <div class="dialog-actions row gap">
        <button type="submit" class="btn primary">שמור</button>
        <button type="button" class="btn ghost" data-close>בטל</button>
      </div>
    </form>
  </dialog>

  <dialog id="journalDialog" class="dialog" aria-label="רשומת יומן">
    <h3 class="dialog-title">רשומת יומן</h3>
    <form id="journalForm" class="form compact dialog-content">
      <label>כותרת
        <input name="title" class="input" required placeholder="יום 1 — נחיתה וסיבוב בעיר">
      </label>
      <label>תוכן
        <textarea name="body" class="input" rows="5" placeholder="מה עשינו היום…"></textarea>
      </label>
      <div class="dialog-actions row gap">
        <button type="submit" class="btn primary">שמור</button>
        <button type="button" class="btn ghost" data-close>בטל</button>
      </div>
    </form>
  </dialog>

  <!-- libs -->
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-auth.js"></script>
  <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-firestore.js"></script>
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

  <!-- app -->
  <script src="firebase.js"></script>
  <script src="script.js"></script>
</body>
</html>
