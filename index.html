<!doctype html>
<html lang="he" dir="rtl">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1" />
    <title>ניהול תקציב טיול — גרסת תיקון</title>
    <link rel="stylesheet" href="style.css" />
  </head>
  <body>
    <header class="app-bar">
      <h1>ניהול תקציב טיול</h1>
      <nav class="app-nav">
        <button class="btn ghost" data-nav="budget" aria-label="מסך תקציב">סיכום</button>
        <button id="btn-open-add-expense" class="btn primary" data-nav="add-expense" aria-label="מסך הוספת הוצאה">+ הוסף הוצאה</button>
        <button class="btn ghost" data-nav="add-journal" aria-label="מסך יומן">יומן יומי</button>
      </nav>
    </header>

    <!-- Screens -->
    <main id="screens">
      <!-- Budget summary screen -->
      <section id="screen-budget" class="screen active">
        <div class="card shadow">
          <h2 class="card-title">סיכום תקציב</h2>
          <div class="budget-row">
            <div class="budget-cell">
              <div class="label">תקציב</div>
              <div id="budget-value" class="value value--emphasis">₪ <span>6,000</span></div>
            </div>
            <div class="budget-cell">
              <div class="label">הוצאות בפועל</div>
              <div id="actual-value" class="value">₪ <span>2,350</span></div>
            </div>
            <div class="budget-cell">
              <div class="label">יתרה</div>
              <div id="balance-value" class="value">₪ <span>3,650</span></div>
            </div>
          </div>
        </div>

        <div class="card shadow">
          <h3 class="card-title">מה חדש בגרסת התיקון</h3>
          <ul class="fix-list">
            <li>הדגשה נשארת <strong>רק</strong> על סכום התקציב. הוצאות ויתרה — ללא הדגשה.</li>
            <li>כפתור <em>הוסף הוצאה</em> מעוצב ונגיש במובייל.</li>
            <li>ביטול שקיפות, ללא פסי גלילה מיותרים.</li>
            <li>בחירת מיקום במסך ייעודי נפרד עם שמירה/ביטול.</li>
            <li>מסך הוספת תיעוד ליומן — זהה בהגדרות למסך ההוצאה.</li>
          </ul>
        </div>
      </section>

      <!-- Add Expense screen -->
      <section id="screen-add-expense" class="screen">
        <form id="expense-form" class="form card shadow" autocomplete="off">
          <div class="form-header">
            <h2>הוספת הוצאה</h2>
          </div>

          <label class="field">
            <span>קטגוריה</span>
            <select name="category" required>
              <option value="">בחרו קטגוריה…</option>
              <option>לינה</option>
              <option>טיסות/נסיעות</option>
              <option>אוכל</option>
              <option>אטרקציות</option>
              <option>אחר</option>
            </select>
          </label>

          <label class="field">
            <span>סכום (₪)</span>
            <input name="amount" type="number" inputmode="decimal" step="0.01" min="0" placeholder="לדוג׳ 120" required />
          </label>

          <label class="field">
            <span>תאריך</span>
            <input name="date" type="date" required />
          </label>

          <label class="field">
            <span>הערה</span>
            <textarea name="note" rows="3" placeholder="פרטים חופשיים…"></textarea>
          </label>

          <div class="field">
            <div class="row">
              <div class="col">
                <div class="location-pill" id="expense-location-pill" aria-live="polite">ללא מיקום</div>
              </div>
              <div class="col col-auto">
                <button type="button" class="btn outline" id="btn-open-location-expense">בחר מיקום</button>
              </div>
            </div>
            <input type="hidden" name="location" id="expense-location-value" />
          </div>

          <div class="actions">
            <button type="submit" class="btn primary wide">שמור הוצאה</button>
            <button type="button" class="btn ghost wide" data-nav="budget">ביטול</button>
          </div>
        </form>
      </section>

      <!-- Location screen (dedicated) -->
      <section id="screen-set-location" class="screen">
        <form id="location-form" class="form card shadow">
          <div class="form-header">
            <h2>בחירת מיקום</h2>
            <p class="sub">מסך ייעודי למיקום — שמור/בטל יחזירו למסך המקור.</p>
          </div>

          <label class="field">
            <span>שם המקום</span>
            <input name="place" type="text" placeholder="לדוג׳ Hostal Centro, Roma" />
          </label>

          <div class="row gap">
            <label class="field">
              <span>קו רוחב (lat)</span>
              <input name="lat" type="text" inputmode="decimal" placeholder="לדוג׳ 41.9028" />
            </label>
            <label class="field">
              <span>קו אורך (lng)</span>
              <input name="lng" type="text" inputmode="decimal" placeholder="לדוג׳ 12.4964" />
            </label>
          </div>

          <div class="hint">לא חייבים מיקום — אפשר לשמור בלי למלא כלום.</div>

          <div class="actions">
            <button type="submit" class="btn primary wide">שמור</button>
            <button type="button" class="btn ghost wide" id="btn-cancel-location">בטל</button>
          </div>
        </form>
      </section>

      <!-- Add Journal Entry screen -->
      <section id="screen-add-journal" class="screen">
        <form id="journal-form" class="form card shadow" autocomplete="off">
          <div class="form-header">
            <h2>הוספת תיעוד יומי</h2>
          </div>

          <label class="field">
            <span>כותרת</span>
            <input name="title" type="text" placeholder="לדוג׳ יום 3 — עמק האגם" required />
          </label>

          <label class="field">
            <span>תאריך</span>
            <input name="date" type="date" required />
          </label>

          <label class="field">
            <span>תיאור</span>
            <textarea name="body" rows="5" placeholder="מה קרה היום…"></textarea>
          </label>

          <div class="field">
            <div class="row">
              <div class="col">
                <div class="location-pill" id="journal-location-pill" aria-live="polite">ללא מיקום</div>
              </div>
              <div class="col col-auto">
                <button type="button" class="btn outline" id="btn-open-location-journal">בחר מיקום</button>
              </div>
            </div>
            <input type="hidden" name="location" id="journal-location-value" />
          </div>

          <div class="actions">
            <button type="submit" class="btn primary wide">שמור תיעוד</button>
            <button type="button" class="btn ghost wide" data-nav="budget">ביטול</button>
          </div>
        </form>
      </section>
    </main>

    <footer class="app-footer">
      <small>גרסת תיקון 07/09 — UI מותאם מובייל, ללא שקיפות/גלילה, מיקום במסך נפרד.</small>
    </footer>

    <script src="script.js"></script>
    <script src="firebase.js"></script>
  </body>
</html>
