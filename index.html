<!DOCTYPE html>

<html dir="rtl" lang="he">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1" name="viewport"/>
<title>Travel Log — יומן מסע (Layout v3)</title>
<script src="https://cdn.tailwindcss.com"></script>
<link href="https://fonts.googleapis.com" rel="preconnect"/>
<link crossorigin="" href="https://fonts.gstatic.com" rel="preconnect"/>
<link href="https://fonts.googleapis.com/css2?family=Heebo:wght@400;600;800&amp;display=swap" rel="stylesheet"/>
<!-- jsPDF -->
<script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
<!-- Leaflet & clusters -->
<link href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" rel="stylesheet"/>
<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
<link href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.css" rel="stylesheet"/>
<link href="https://unpkg.com/leaflet.markercluster@1.4.1/dist/MarkerCluster.Default.css" rel="stylesheet"/>
<script src="https://unpkg.com/leaflet.markercluster@1.4.1/dist/leaflet.markercluster.js"></script>
<!-- Icons -->
<script src="https://unpkg.com/lucide@latest"></script>
  <link rel="stylesheet" href="./style.css?v=popup-fix">
</head>
<body class="font-heebo bg-gradient-to-b from-slate-900 to-slate-800 text-slate-100 min-h-screen">
<!-- Top Bar -->
<header class="sticky top-0 z-30 backdrop-blur supports-[backdrop-filter]:bg-white/5 bg-white/10 border-b border-white/10">
<div class="max-w-7xl mx-auto px-4 py-3 flex items-center justify-between">
<div class="flex items-center gap-3">
<div class="w-9 h-9 rounded-2xl bg-emerald-500/20 grid place-items-center ring-1 ring-emerald-500/40">
<i class="w-5 h-5 text-emerald-300" data-lucide="globe-2"></i>
</div>
<h1 class="text-xl sm:text-2xl font-extrabold tracking-tight text-emerald-200">Travel Log</h1>
</div>
<div class="flex items-center gap-2">
<button class="btn-solid-emerald" id="addTripBtn">
<i class="w-5 h-5" data-lucide="plus-circle"></i><span>הוסף טיול</span>
</button>
<button class="btn-ghost" id="themeToggle">
<i class="w-5 h-5" data-lucide="sun-moon"></i>
</button>
</div>
</div>
</header>
<main class="max-w-7xl mx-auto p-4 md:p-6 grid gap-6">
<!-- MAIN SCREEN: Trips -->
<section class="card-neo" id="main-screen">
<div class="flex items-center justify-between mb-4">
<h2 class="text-lg md:text-xl font-bold text-emerald-200">הטיולים שלי</h2>
</div>
<ul class="grid sm:grid-cols-2 lg:grid-cols-3 gap-4" id="tripList"></ul>
</section>
<!-- TRIP EDITOR -->
<section class="hidden card-neo" id="tripEditor">
<!-- Editor header -->
<div class="flex flex-col md:flex-row md:items-center md:justify-between gap-3 border-b border-white/10 pb-4 mb-4">
<div class="flex items-center justify-between gap-3">
<div class="flex items-center gap-3"><h2 class="text-2xl font-extrabold text-emerald-200" id="tripDestinationHeader">יעד</h2><button aria-label="חזור" class="btn-ghost" id="backBtn">
<i class="w-6 h-6" data-lucide="arrow-right"></i>
</button></div></div>
<div class="flex flex-wrap gap-2">
<button class="btn-solid-emerald" id="saveTripDetails"><i class="w-5 h-5" data-lucide="save"></i><span>שמור</span></button>
<button class="btn-soft hidden" id="shareTripBtn">שתף</button>
<button class="btn-soft hidden" id="unshareTripBtn">בטל שיתוף</button>
<button class="btn-soft hidden" id="exportCsvBtn">CSV</button>
<button class="btn-soft hidden" id="exportPdfBtn">PDF</button>
<button class="btn-soft hidden" id="exportGpxBtn">GPX</button>
</div>
<div class="flex items-center gap-2" id="tripToolbar">



<button class="btn-soft" id="exportPdfBtn"><span>ייצא PDF</span></button>
<button class="btn-soft" id="exportGpxBtn"><span>ייצא GPX</span></button>
<button class="btn-soft" id="exportCsvBtn"><span>ייצא CSV</span></button>
</div></div>
<!-- Tabs -->
<nav class="tabs">
<button class="tab-btn" data-target="#all"><i class="w-4 h-4" data-lucide="layout-grid"></i><span>הצג הכל</span></button>
<button class="tab-btn active" data-target="#details-section"><i class="w-4 h-4" data-lucide="info"></i><span>פרטים</span></button>
<button class="tab-btn" data-target="#expenses-section"><i class="w-4 h-4" data-lucide="tag"></i><span>הוצאות</span></button>
<button class="tab-btn" data-target="#logs-section"><i class="w-4 h-4" data-lucide="book-open"></i><span>תיעוד ומפה</span></button>
</nav>
<!-- DETAILS -->
<section class="grid lg:grid-cols-2 gap-6 mt-4" id="details-section">
<div class="panel">
<h3 class="panel-title"><i class="w-5 h-5 text-emerald-300" data-lucide="info"></i><span>פרטים כלליים</span></h3>
<div class="grid gap-4">
<div>
<label class="label" for="destinationInput">יעד</label>
<input class="input" id="destinationInput" placeholder="לדוגמה: פולין, ורשה"/>
</div>
<div>
<label class="label" for="holidayTypeInput">סוג טיול</label>
<input class="input" id="holidayTypeInput" placeholder="בטן-גב / סקי / טרקים"/>
</div>
<div>
<label class="label" for="participantsInput">משתתפים</label>
<input class="input" id="participantsInput" placeholder="מי משתתף?"/>
</div>
<div class="grid grid-cols-2 gap-3">
<div>
<label class="label" for="startDateInput">תאריך התחלה</label>
<input class="input" id="startDateInput" type="date"/>
</div>
<div>
<label class="label" for="endDateInput">תאריך סיום</label>
<input class="input" id="endDateInput" type="date"/>
</div>
</div>
</div>
</div>
<div class="panel">
<h3 class="panel-title"><i class="w-5 h-5 text-emerald-300" data-lucide="wallet"></i><span>ניהול תקציב</span></h3>
<div class="grid gap-4">
<div>
<label class="label">תקציב כולל</label>
<div class="grid grid-cols-3 gap-2">
<input class="input text-center no-spinners" id="usdBudget" placeholder="USD" type="number"/>
<input class="input text-center no-spinners" id="eurBudget" placeholder="EUR" type="number"/>
<input class="input text-center no-spinners" id="ilsBudget" placeholder="ILS" type="number"/>
</div>
</div>
<div>
<label class="label">הוצאות בפועל</label>
<div class="grid grid-cols-3 gap-2">
<input class="input bg-white/5 text-center" id="totalUsdSpent" readonly=""/>
<input class="input bg-white/5 text-center" id="totalEurSpent" readonly=""/>
<input class="input bg-white/5 text-center" id="totalIlsSpent" readonly=""/>
</div>
</div>
<div>
<label class="label">יתרה</label>
<div class="grid grid-cols-3 gap-2">
<input class="input text-center" id="remainingUsd" readonly=""/>
<input class="input text-center" id="remainingEur" readonly=""/>
<input class="input text-center" id="remainingIls" readonly=""/>
</div>
</div>
<div class="flex gap-2">
<button class="btn-soft-emerald" id="updateBudgetBtn"><i class="w-4 h-4" data-lucide="save"></i><span>עדכן תקציב</span></button>
<button class="btn-soft-amber hidden" id="editBudgetBtn"><i class="w-4 h-4" data-lucide="edit-2"></i><span>ערוך תקציב</span></button>
</div>
</div>
</div>
</section>
<section class="hidden grid gap-6 mt-4" id="expenses-section">
<div class="panel">
<div class="flex justify-between items-center mb-3">
<h3 class="panel-title"><i class="w-5 h-5 text-amber-300" data-lucide="tag"></i><span>הוצאות</span></h3>
<div class="flex items-center gap-2">
<button aria-label="מיין הוצאות" class="btn-ghost" id="sortExpensesBtn">
<i class="w-5 h-5" data-lucide="arrow-down-up"></i>
</button>
<button class="btn-solid-emerald" id="addExpenseBtn"><i class="w-5 h-5" data-lucide="plus"></i><span>הוסף הוצאה</span></button>
</div>
</div>
<ul class="grid gap-3" id="expenseList"></ul>
</div>
</section>
<!-- LOGS + MAP -->
<section class="hidden grid gap-6 mt-4" id="logs-section">
<div class="panel">
<h3 class="panel-title"><i class="w-5 h-5 text-purple-300" data-lucide="book-open"></i><span>תיעוד יומי</span></h3>
<div class="grid gap-4">
<div class="flex items-center gap-2">
<button aria-label="מיין תיעוד יומי" class="btn-ghost" id="sortLogsBtn"><i class="w-5 h-5" data-lucide="arrow-down-up"></i></button>
<button aria-label="קבע מיקום לתיעוד יומי" class="btn-ghost" id="setDailyLogLocationBtn"><i class="w-5 h-5" data-lucide="map-pin"></i></button>
<span class="text-slate-300/80 text-xs" id="dailyLogLocationDisplay"></span>
</div>
<textarea class="input min-h-[120px]" id="dailyLogInput" placeholder="מה עשינו היום?" rows="4"></textarea>
<div class="flex flex-col md:flex-row gap-3 items-center">
<label class="file:mr-4 file:py-2 file:px-4 file:rounded-xl file:border file:border-white/10 file:text-sm file:font-semibold file:bg-white/5 file:text-emerald-200 hover:file:bg-white/10 cursor-pointer">
<input accept="image/*,video/*" class="hidden" id="imageInput" multiple="" type="file"/>
<span>בחר תמונה/סרטון</span>
</label>
<button class="btn-solid-emerald w-full md:w-auto" id="addLogBtn">
<div class="spinner hidden" id="log-spinner"></div>
<i class="w-5 h-5" data-lucide="plus-circle" id="add-log-icon"></i><span>הזן תיעוד</span>
</button>
</div>
<div class="grid grid-cols-2 sm:grid-cols-3 md:grid-cols-4 lg:grid-cols-5 gap-4" id="gallery"></div>
<div class="grid gap-3" id="logsArea"></div>
</div>
</div>
<div class="panel">
<h4 class="panel-title"><i class="w-5 h-5 text-rose-300" data-lucide="map-pin"></i><span>מפת הטיול</span></h4>
<div class="flex gap-2 mb-3">
<button class="chip active" id="filterAllBtn"><i class="w-4 h-4" data-lucide="map"></i><span>כל הנקודות</span></button>
<button class="chip" id="filterExpensesBtn"><i class="w-4 h-4" data-lucide="tag"></i><span>הוצאות</span></button>
<button class="chip" id="filterLogsBtn"><i class="w-4 h-4" data-lucide="book"></i><span>תיעוד יומי</span></button>
</div>
<div class="rounded-2xl overflow-hidden ring-1 ring-white/10" id="map" style="width:100%; height:420px;"></div>
</div>
</section>
<!-- Modals (IDs must exist for script.js) -->
<div class="modal hidden" id="alertModal">
<div class="modal-card">
<p class="mb-4" id="alertMessage">Alert</p>
<button class="btn-solid-emerald w-full" id="alertCloseBtn">סגור</button>
</div>
</div>
<div class="modal hidden" id="confirmModal">
<div class="modal-card">
<p class="mb-4" id="confirmMessage">Confirm?</p>
<div class="flex gap-2">
<button class="btn-solid-emerald flex-1" id="confirmYesBtn">כן</button>
<button class="btn-soft flex-1" id="confirmNoBtn">לא</button>
</div>
</div>
</div>
<div class="modal hidden" id="setLocationModal">
<div class="modal-card">
<h4 class="text-lg font-bold mb-2">קביעת מיקום</h4>
<input class="input w-full mb-3" id="locationNameInput" placeholder="לדוגמה: כיכר הונגרית, בודפשט"/>
<div class="flex gap-2">
<button class="btn-soft flex-1" id="getLocationBtn">מיקום נוכחי</button>
<button class="btn-solid-emerald flex-1" id="saveLocationBtn">שמור</button>
<button class="btn-soft flex-1" id="cancelLocationBtn">ביטול</button>
</div>
</div>
</div>
</section>
</main>
<script src="./firebase.js" type="module"></script>
<script src="./script.js" type="module"></script>
<script>
    document.addEventListener('DOMContentLoaded', () => { try { lucide.createIcons(); } catch(e){} });
  </script>
</body>
</html>
